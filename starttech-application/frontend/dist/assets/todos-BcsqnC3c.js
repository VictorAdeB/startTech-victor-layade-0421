import{c as p,u as h,a as u,t as o,b as d,j as e,o as y,s as x,d as j,e as v,r as N,f as k}from"./index-CmilNsW5.js";import{C as g,c as m,B as f}from"./button-ZW-BgD01.js";import{C as w,T as C,I as T}from"./input-BDCx5lo_.js";import{u as S,a as q}from"./zod-BsoTg_zf.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],M=p("loader-circle",F);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],L=p("plus",E);function Q({todo:s}){const t=h(),a=u({mutationFn:async()=>(await d.put(`/tasks/${s.id}`,{completed:!s.completed})).data,onSuccess:()=>{t.invalidateQueries({queryKey:["todos"]})},onError:()=>{o.error("Failed to update task")}}),r=u({mutationFn:async()=>{await d.delete(`/tasks/${s.id}`)},onSuccess:()=>{t.invalidateQueries({queryKey:["todos"]}),o.success("Task deleted")},onError:()=>{o.error("Failed to delete task")}});return e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(w,{checked:s.completed,onCheckedChange:()=>a.mutate(),disabled:a.isPending}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:m("text-lg font-medium transition-all",s.completed?"text-muted-foreground line-through":"text-foreground"),children:s.title}),s.description&&e.jsx("p",{className:m("text-sm text-muted-foreground",s.completed&&"line-through opacity-70"),children:s.description})]})]}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>r.mutate(),disabled:r.isPending,className:"text-muted-foreground hover:text-destructive hover:bg-destructive/10 transition-colors","aria-label":"Delete todo",children:e.jsx(C,{className:"w-5 h-5"})})]})})}function A({className:s,...t}){return e.jsx("textarea",{"data-slot":"textarea",className:m("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...t})}const I=y({title:x().min(1,"Title is required"),description:x().optional()});function K(){const s=h(),{register:t,handleSubmit:a,reset:r,formState:{errors:n,isSubmitting:c}}=S({resolver:q(I)}),i=u({mutationFn:async l=>(await d.post("/tasks",l)).data,onSuccess:()=>{s.invalidateQueries({queryKey:["todos"]}),r(),o.success("Task added")},onError:()=>{o.error("Failed to create task")}}),b=l=>{i.mutate(l)};return e.jsx(g,{className:"mb-8 p-4",children:e.jsxs("form",{onSubmit:a(b),className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(T,{type:"text",placeholder:"What needs to be done?",...t("title")}),n.title&&e.jsx("p",{className:"text-destructive text-xs mt-1",children:n.title.message})]}),e.jsxs(f,{type:"submit",disabled:c||i.isPending,className:"gap-2 shrink-0",children:[e.jsx(L,{className:"w-5 h-5"}),"Add Task"]})]}),e.jsx(A,{placeholder:"Description (optional)",...t("description")})]})})}function D(){const{user:s,isLoading:t}=j(),a=v();N.useEffect(()=>{!t&&!s&&a({to:"/login"})},[s,t,a]);const{data:r,isLoading:n,error:c}=k({queryKey:["todos"],queryFn:async()=>(await d.get("/tasks")).data,enabled:!!s});return t||n&&!c?e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(M,{className:"h-8 w-8 animate-spin text-indigo-600"})}):s?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Tasks"}),e.jsxs("p",{className:"mt-2 text-gray-600",children:["Welcome back, ",s.firstName,"! Here's what you need to do."]})]}),e.jsx(K,{}),e.jsx("div",{className:"space-y-4",children:r?.length===0?e.jsx("div",{className:"text-center py-12 bg-white rounded-lg border border-gray-200 border-dashed",children:e.jsx("p",{className:"text-gray-500",children:"No todos yet. Add one above!"})}):r?.map(i=>e.jsx(Q,{todo:i},i.id))})]})}):null}export{D as component};
