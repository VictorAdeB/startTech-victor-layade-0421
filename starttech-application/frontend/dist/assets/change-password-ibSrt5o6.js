import{c as b,e as k,r as h,o as M,a as A,t as p,b as $,j as s,s as g}from"./index-CmilNsW5.js";import{u as F,a as z}from"./zod-BsoTg_zf.js";import{K as E}from"./key-round-Brc9WEs5.js";import{C as l}from"./circle-check-DkHSBnkt.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],w=b("eye-off",Z);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],u=b("eye",_),O=M({oldPassword:g().min(1,"Current password is required"),newPassword:g().min(8,"Password must be at least 8 characters"),confirmPassword:g().min(1,"Please confirm your password")}).refine(o=>o.newPassword===o.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function I(){const o=k(),[d,f]=h.useState(!1),[c,y]=h.useState(!1),[i,j]=h.useState(!1),{register:m,handleSubmit:N,formState:{errors:r},watch:P,reset:v}=F({resolver:z(O)}),a=P("newPassword",""),n=A({mutationFn:async e=>(await $.put("/users/me/password",e)).data,onSuccess:()=>{p.success("Password changed successfully"),v(),setTimeout(()=>{o({to:"/profile"})},1500)},onError:e=>{const t=e.response?.data?.error||"Failed to change password";p.error(t)}}),C=e=>{const{oldPassword:t,newPassword:S}=e;n.mutate({oldPassword:t,newPassword:S})},x=(e=>{if(e.length===0)return{strength:0,label:"",color:""};if(e.length<8)return{strength:1,label:"Too short",color:"bg-red-500"};let t=0;return e.length>=8&&t++,e.length>=12&&t++,/[a-z]/.test(e)&&/[A-Z]/.test(e)&&t++,/\d/.test(e)&&t++,/[^a-zA-Z\d]/.test(e)&&t++,t<=2?{strength:2,label:"Weak",color:"bg-orange-500"}:t<=3?{strength:3,label:"Medium",color:"bg-yellow-500"}:{strength:4,label:"Strong",color:"bg-green-500"}})(a);return s.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:s.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(E,{className:"h-8 w-8 text-indigo-600"}),"Change Password"]}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Update your account password"})]}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6 shadow-sm",children:s.jsxs("form",{onSubmit:N(C),className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"oldPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"oldPassword",type:d?"text":"password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 pr-10",...m("oldPassword")}),s.jsx("button",{type:"button",onClick:()=>f(!d),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:d?s.jsx(w,{className:"h-5 w-5"}):s.jsx(u,{className:"h-5 w-5"})})]}),r.oldPassword&&s.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.oldPassword.message})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"newPassword",type:c?"text":"password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 pr-10",...m("newPassword")}),s.jsx("button",{type:"button",onClick:()=>y(!c),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:c?s.jsx(w,{className:"h-5 w-5"}):s.jsx(u,{className:"h-5 w-5"})})]}),r.newPassword&&s.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.newPassword.message}),a&&s.jsxs("div",{className:"mt-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:`h-full transition-all ${x.color}`,style:{width:`${x.strength/4*100}%`}})}),s.jsx("span",{className:"text-xs font-medium text-gray-600",children:x.label})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Use at least 8 characters with a mix of letters, numbers, and symbols"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"confirmPassword",type:i?"text":"password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 pr-10",...m("confirmPassword")}),s.jsx("button",{type:"button",onClick:()=>j(!i),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:i?s.jsx(w,{className:"h-5 w-5"}):s.jsx(u,{className:"h-5 w-5"})})]}),r.confirmPassword&&s.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.confirmPassword.message})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[s.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Password Requirements:"}),s.jsxs("ul",{className:"space-y-1 text-sm text-blue-800",children:[s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(l,{className:`h-4 w-4 ${a.length>=8?"text-green-600":"text-gray-400"}`}),"At least 8 characters"]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(l,{className:`h-4 w-4 ${/[a-z]/.test(a)&&/[A-Z]/.test(a)?"text-green-600":"text-gray-400"}`}),"Mix of uppercase and lowercase letters"]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(l,{className:`h-4 w-4 ${/\d/.test(a)?"text-green-600":"text-gray-400"}`}),"At least one number"]}),s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(l,{className:`h-4 w-4 ${/[^a-zA-Z\d]/.test(a)?"text-green-600":"text-gray-400"}`}),"At least one special character"]})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{type:"submit",disabled:n.isPending,className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 transition-colors",children:n.isPending?"Changing Password...":"Change Password"}),s.jsx("button",{type:"button",onClick:()=>o({to:"/profile"}),disabled:n.isPending,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})})]})})}export{I as component};
